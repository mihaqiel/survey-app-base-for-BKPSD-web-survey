// app/prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql" // or "mysql"
  url      = env("DATABASE_URL")
}

// üóìÔ∏è GLOBAL PERIOD (The Gatekeeper)
model Periode {
  id        String   @id @default(cuid())
  label     String   @default("Global Access")
  status    String   @default("AKTIF") 
  token     String   @unique
  respon    Respon[]
  createdAt DateTime @default(now())
}

// üè¢ FIXED SERVICE (22 Layanan) - ‚ö†Ô∏è ENSURE NO 'perangkatId' HERE
model Layanan {
  id        String   @id @default(cuid())
  nama      String
  respon    Respon[]
}

// üë®‚Äçüíº EMPLOYEE
model Pegawai {
  id        String   @id @default(cuid())
  nama      String
  respon    Respon[]
}

// üìù RESPONSE
model Respon {
  id          String   @id @default(cuid())
  
  // Relations
  periodeId   String
  periode     Periode  @relation(fields: [periodeId], references: [id])
  
  layananId   String
  layanan     Layanan  @relation(fields: [layananId], references: [id])
  
  pegawaiId   String
  pegawai     Pegawai  @relation(fields: [pegawaiId], references: [id])

  // Demographics
  nama             String
  usia             Int
  jenisKelamin     String
  pendidikan       String
  pekerjaan        String
  isDifabel        String
  jenisDisabilitas String?
  tglLayanan       DateTime
  
  // Scores
  u1 Int
  u2 Int
  u3 Int
  u4 Int
  u5 Int
  u6 Int
  u7 Int
  u8 Int
  u9 Int
  
  saran     String?
  ipAddress String?
  createdAt DateTime @default(now())
}

// üìú SYSTEM AUDIT LOG
model LogActivity {
  id        String   @id @default(cuid())
  action    String   // e.g., "CREATE", "DELETE", "ARCHIVE"
  target    String   // e.g., "Periode: SKM Q1 2024"
  details   String?  // Optional extra information
  timestamp DateTime @default(now()) // Used for "Newest first" sorting
}